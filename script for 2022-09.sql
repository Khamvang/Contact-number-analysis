#=========== Prepare contact for LCC, for Area marketing ===============
-- 1) table contact_for  
create table `contact_for_202209_lcc` (
  `id` int NOT NULL AUTO_INCREMENT,
  `file_id` int DEFAULT NULL,
  `contact_no` varchar(255) NOT NULL,
  `name` varchar(255) DEFAULT NULL,
  `province_eng` varchar(255) DEFAULT NULL,
  `province_laos` varchar(255) DEFAULT NULL,
  `district_eng` varchar(50) DEFAULT NULL,
  `district_laos` varchar(255) DEFAULT NULL,
  `village` varchar(255) DEFAULT NULL,
  `type` varchar(255) DEFAULT NULL,
  `maker` varchar(255) DEFAULT NULL,
  `model` varchar(255) DEFAULT NULL,
  `year` varchar(255) DEFAULT NULL,
  `remark_1` varchar(255) DEFAULT null COMMENT '1=F&G SMS checked, 2=Ringi_Asset_SABC, 3=Telecom_active, 4=ANSWERED',
  `remark_2` varchar(255) DEFAULT NULL,
  `remark_3` varchar(255) DEFAULT NULL,
  `branch_name` varchar(255) DEFAULT NULL,
  `status` varchar(255) DEFAULT NULL,
  `status_updated` varchar(255) DEFAULT NULL,
  `staff_id` varchar(255) DEFAULT NULL,
  `pvd_id` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`),
  key `contact_no` (`contact_no`),
  KEY `fk_file_id` (`file_id`),
  CONSTRAINT `contact_for_202209_lcc_ibfk_1` FOREIGN KEY (`file_id`) REFERENCES `file_details` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8mb4 collate utf8mb4_general_ci ;


-- --------------------------------Check and update ------------------------------------
select count(*) from contact_numbers_to_lcc cntl where branch_name = 'Sainyabuli'; -- Vientiane province 

update contact_numbers_to_lcc set branch_name = 'Xainyabuli' where branch_name = 'Sainyabuli';

select distinct branch_name from contact_numbers_to_lcc;

-- update the branch null for F&G that SMS checked
select id, file_id  from contact_numbers_to_lcc cntl where branch_name is null 
	and (cntl.remark_3 = 'prospect_sabc' and cntl.status in ('F','G','G1','G2'))
	and cntl.id in (select id from temp_sms_chairman tean where date_updated >= '2022-08-01' and status = 1);

update contact_numbers_to_lcc set branch_name = 'Head Office'
where id in (1035327,1035960,1045085,1045170,1045903,1045973,1046518,1047268,1047412,1049370,1051325,1053821,1054520,1056680,1061992,1068496,1081150,1081556,1084948,1086962,1087260,1088521,1090409,1093012,1098489,1098923,1099301,1099336,1099356,1099404,1099678,1101165,1101216,1101966,1101969,1102166,1102478,1103446,1103460,1104195,1104583,1104790,1105159,1105485,1106536,1106826,1107064,1109649,1111147,1112185,1117963,1118251,1118614,1119419,1120255,1120558,1120795,1122260,1124633,1126977,1128802,1129885,1130769,1130770,1131197,1131679,1168641,1175429,1186772,1191164,1197766,1203707,1205624,1206855,1208493,1221812,1227283,1230227,1232370,1233065,1233422,1252146,1252960,1252966,1257605,1259835,1262239,1303666,1305913,1306729,1308892,1311172,3229297,3231981,3236937,3238584,3239386,3252835,3253501,3263847,3267306,3269300,3271101,3272674,3279026,3286806,3298309,3304895,3306681,3307546,3308137,3311754,3371169,3374109,3374478,3387369,3392458,3394714,3394840,3396231,3404011,3404367,3435352,3435986,3448067,3456927,3458009,3502038,3502833,3504632,3523246,3526369,3538454,3546140,3546240,3546908,3549384,3551470,3560115,3563444,3578182,3583764,3583775,3621294,3621440,3622018,3623660,3624322,3625326,3626084,3626104,3626245,3626567,3628721,3629161,3629556,3629714,3631006,3631272,3632095,3633781,3634386,3634718,3634835,3635150,3635491,3636465,3637284,3637813,3639945,3640532,3640730,3641336,3642177,3642365,3642383,3642538,3643721,3644433,3644757,3644969,3646724,3647648,3648012,3649078,3649427,3649706,3651479,3651539,3651567,3651714,3651848,3651881,3652226,3652406,3652788,3654866,3654979,3655029,3655033,3655473,3655930,3656128,3656450,3657467,3658296,3658405,3658435,3658592,3658960,3659788,3661744,3661874,3661915,3662738,3664445,3668891,3669615,3670869,3671693,3671836,3672259,3675741,3675843,3675862,3676579,3678458,3678486,3678666,3679410,3680539,3680699,3681640,3681641,3683186,3683785,3683982,3684335,3684688,3684836,3686204,3686366,3686544,3687060,3687445,3687994,3688022,3688388,3690957,3691519,3693279,3695057,3695309,3696155,3696393,3697004,3697046,3698437,3698671,3698782,3699457,3700640,3700803,3700804,3701949,3703031,3703060,3703847,3704865,3706695,3708699,3710297,3711084,3711232,3712704,3713380,3713532,3713940,3714335,3715738,3715808,3715865,3715908,3716067,3716080,3717039,3717646,3717733,3717941,3718687,3718818,3718872,3719356,3720018,3751746,3752198,3752518,3753296,3753341,3753391,3753576,3753589,3754012,3754288,3754399,3754405,3754423,3754767,3756544,3756671,3757479,3757830,3758152,3758592,3759456,3759725,3760680,3760949,3761192,3761671,3761811,3762296,3762881,3762998,3763499,3763893,3764077,3764316,3764477,3764498,3764886,3764890,3765001,3765022,3765273,3765938,3766103,3766761,3766771,3767107,3767473,3767583,3767789,3767821,3767992,3768079,3768361,3769047,3769263,3769698,3769821,3770630,3770689,3770929,3772116,3773697,3773710,3774025,3774071,3775177,3775552,3775743,3775823,3776317,3779588,3780205,3781113,3781239,3782084,3782085,3783368,3784326,3784404,3784984,3785364,3785559,3786247,3786425,3786892,3787108,3787188,3787303,3787380,3787685,3788035,3788137,3789184,3789833,3790390,3791414,3792446,3793206,3793349,3794206,3794469,3795370,3795603,3796236,3796376,3796620,3796693,3796754,3796812,3797469,3797548,3797756,3797993,3798063,3798086,3799753,3800273,3800767,3800796,3802703,3802747,3803603,3805519,3805727,3805961,3806130,3806256,3806576,3807466,3808168,3808357,3808901,3809718,3809970,3810178,3810187,3810618,3810876,3811150,3811227,3811919,3812107,3812262,3813148,3813734,3813739,3813908,3815636,3815779,3815892,3816259,3816760,3817406,3818583,3820274,3820971,3821667,3822108,3822126,3825130,3825225,3825791,3826344,3827537,3827559,3827794,3828132,3829905,3829984,3830322,3831680,3831900,3832840,3833056,3833302,3833534,3833775,3834247,3835214,3836371,3836727,3837222,3838171,3838588,3838751,3838819,3839477,3840213,3841975,3842059,3843486,3843961,3844550,3845193,3845464,3845980,3846019,3846602,3846617,3846965,3847224,3847406,3847612,3847652,3847712,3847882,3847928,3848099,3848873,3848894,3849782,3849838,3850109,3850120,3850703,3882942,3883182,3884018,3885128,3885724,3885764,3885786,3885979,3888625,3888652,3888724,3888805,3889281,3889283,3889504,3889878,3890075,3890548,3890560,3892414,3893708,3894201,3894437,3894879,3894889,3895814,3895951,3895953,3895956,3896376,3896551,3896660,3896917,3897740,3898114,3898487,3898661,3898674,3900422,3901238,3901605,3901800,3902128,3902858,3903484,3903602,3904327,3904639,3905235,3905764,3905910,3906421,3906683,3907784,3907839,3908339,3908349,3909024,3909600,3910206,3910955,3911171,3911264,3911476,3912201,3912541,3912637,3913625,3914060,3914374,3916004,3916837,3917919,3918579,3920283,3921372,3921472,3921493,3923945,3924423,3924458,3924855,3924863,3925206,3925363,3926092,3928537,3928893,3929267,3929487,3929804,3929897,3930278,3930635,3931015,3931762,3931914,3932027,3933570,3933900,3934177,3935253,3937032,3937099,3937122,3937921,3938765,3939394,3939547,3940271,3940450,3940916,3941465,3942499,3942538,3942968,3944517,3944897,3945002,3945326,3945905,3946410,3946981,3947292,3947863,3947902,3947925,3948063,3949299,3949929,3949940,3950343,3950378,3951279,3951355,3951716,3951766,3952007,3952099,3952552,3952746,3953072,3953074,3953298,3953594,3953781,3953997,3954070,3954228,3955229,3955299,3955435,3956593,3956600,3957200,3957250,3957600,3957768,3958210,3958479,3958583,3959455,3959702,3959796,3960458,3960665,3961135,3961929,3962092,3962321,3962935,3963434,3964919,3965395,3965723,3966210,3966808,3967666,3968598,3968604,3968740,3969177,3970079,3970350,3972728,3972861,3972897,3972984,3973352,3973992,3974492,3974527,3975168,3975251,3975374,3976858,3978051,3978229,3978747,3979073,3979198,3979963,3980173,3980191,3980314,3980435,3980483,3980740,3981364,3981604,4014448,4014499,4014703,4014823,4015308,4016047,4016176,4016310,4016510,4017028,4017061,4018665,4018686,4019272,4019321,4019382,4020139,4020397,4020825,4021233,4021503,4021861,4022024,4022165,4022248,4023385,4023687,4024526,4024682,4024779,4025271,4025734,4026065,4026095,4026203,4026256,4027118,4027192,4027383,4027554,4027744,4028394,4028571,4029527,4029543,4030975,4031741,4033352,4033493,4033645,4034031,4034042,4034232,4034839,4034919,4035012,4035206,4035310,4035823,4035879,4036389,4037034,4037558,4038156,4038306,4039128,4039152,4039640,4039669,4039765,4040611,4042037,4042061,4042435,4042656,4042907,4043006,4043132,4043949,4044630,4045227,4046827,4048903,4049410,4050124,4050741,4050901,4051379,4051541,4052542,4053132,4053412,4053480,4054680,4055093,4055417,4055743,4055983,4056559,4056613,4056693,4056970,4057197,4057926,4058249,4059143,4059229,4060220,4060344,4060923,4060967,4062217,4062706,4063111,4063373,4063942,4064301,4064360,4064909,4064992,4065264,4065320,4065507,4065864,4066058,4067169,4067495,4068463,4068855,4069848,4070105,4070115,4070371,4070626,4070892,4071315,4071692,4072138,4072255,4072621,4072883,4073287,4073973,4074821,4075400,4075407,4075958,4076600,4076977,4077118,4077132,4077223,4077355,4077535,4077676,4077855,4078318,4078605,4078611,4078853,4079180,4079378,4079712,4080533,4080607,4080682,4081055,4081309,4081358,4081862,4082180,4082285,4082502,4082524,4082528,4082765,4083024,4083124,4083252,4083527,4083952,4084053,4084626,4084978,4085766,4085819,4086068,4086466,4086552,4086692,4086727,4086789,4087060,4087660,4087843,4087968,4087983,4088005,4088291,4089296,4089844,4090048,4090476,4090577,4092014,4092367,4092479,4093045,4093090,4093402,4093492,4093815,4093891,4094194,4094282,4094545,4094602,4094663,4095024,4095288,4095620,4096257,4096766,4097363,4098866,4098870,4098967,4099840,4100130,4100152,4101208,4101970,4102317,4102817,4103065,4103303,4103555,4103632,4103805,4104467,4104494,4104611,4105024,4105365,4105368,4106571,4106763,4107055,4107484,4107507,4108504,4108662,4109030,4109726,4109847,4109863,4110037,4110495,4110521,4111191,4111567,4111654,4111711,4112513,4113030,4145610,4145695,4146082,4146476,4146866,4147639,4147870,4148196,4148629,4149179,4149696,4150052,4150135,4150429,4151399,4151529,4152400,4152600,4153584,4154317,4154441,4154568,4154600,4154911,4155595,4155617,4155688,4155689,4156133,4157095,4157114,4157139,4157448,4157454,4157478,4157479,4157604,4157827,4157884,4157935,4157992,4158003,4158222,4158309,4158402,4158599,4158823,4159058,4159162,4159470,4159649,4160247,4160281,4160347,4160424,4160742,4160876,4161597,4162095,4162250,4162712,4163415,4163563,4163906,4163908,4164039,4165850,4166041,4167785,4167886,4168232,4168379,4168386,4168687,4169041,4169452,4170007,4171229,4171571,4171777,4172013,4172125,4173932,4174378,4174584,4174596,4174715,4174748,4175000,4175251,4175311,4175632,4175683,4175729,4176840,4176897,4176923,4177201,4177225,4177738,4177820,4178062,4178076,4178160,4178528,4179421,4180000,4180021,4180459,4181127,4181433,4181690,4181970,4182025,4182592,4182869,4183318,4183484,4183555,4183597,4183606,4183709,4183832,4183895,4184410,4184412,4184486,4185298,4185550,4185771,4185788,4185909,4186099,4186118,4186379,4186588,4186933,4187027,4187296,4187764,4188135,4188679,4189239,4190296,4191038,4191527,4192218,4192323,4192379,4192432,4192529,4192575,4192626,4192628,4192673,4192898,4192995,4193591,4193703,4193972,4194067,4194796,4195395,4195507,4195906,4197506,4198721,4199306,4199453,4199922,4200169,4200387,4200444,4200729,4200905,4201283,4202012,4202254,4203772,4203792,4204141,4204203,4204321,4204424,4205617,4206182,4206397,4206620,4206623,4207077,4207791,4208170,4208286,4208517,4208560,4208592,4208645,4208806,4208857,4209162,4209318,4209379,4209540,4209728,4209856,4210558,4210772,4210859,4211366,4211886,4212021,4212285,4212331,4212509,4212761,4213019,4213070,4213168,4213239,4213326,4213445,4214126,4214189,4214403,4214557,4214883,4215199,4215797,4216411,4216634,4216721,4216753,4217038,4217192,4217233,4217371,4218011,4220099,4220209,4220406,4220743,4221411,4221507,4221704,4221749,4221849,4221867,4221870,4221907,4221922,4222109,4222133,4222428,4222811,4222845,4222878,4222915,4223016,4223258,4223259,4223341,4223420,4223483,4223829,4224308,4224379,4224640,4225019,4225141,4225182,4225339,4225575,4225716,4225758,4225759,4225799,4225804,4225869,4225922,4225924,4226022,4226061,4226228,5972798,5972851,5975452,5976582,5976969,5978820,5982021,6017251,6018039,6020577,6022050,6022074,6022382,6022841,6024129,6024167,6024838,6025457,6025499,6025803,6027212,6031248,6031257,6032133,6032755,6033650,6033685,6033696,6033746,6034111,7838876,7858443,7896625,7897954,7901140,7904849,7906415,7907404,7909245,7910041,7917407,10287820,10288068,10288718,10288821,10291564,10292382,10292576,11065416,11069094,11072618,11073121,11075388,11075578,11076060,11076639,11077554,11077607,11078075,11078442,11079400,11082394,11084891,11085790,11085886,11091448,11092155,11092195,11092498,11093973,11093997,11094569,11096893,11097664,11098074,11098553,11098634,11099261,11102729,11104471,11105371,11107061,11107626,11108857,11109002,11109679,11112975,11113549,11114507,11114657,11114816,11116192,11117935,11118164,11118616,11120327,11120422,11120509,11121738,11122066,11122982,11123020,11125048,11125104,11126673,11126764,11126893,11127561,11132093,11133529,11134920,11135121,11141635,11142182,11143820,11144342,11144591,11144893,11145809,11146075,11147703,11148092,11149007,11150809,11153723,11154157,11154824,11156093,11157031,11157513,11159126,11159781,11160136,11160683,11161264,11162442,11162786,11164354,11166582,11199463,11203001,11203146,11205778,11206513,11206960,11209323,11210068,11210880,11212561,11213646,11213902,11218081,11221428,11221740,11222189,11222790,11224349,11228665,11228980,11229430,11229629,11229829,11229880,11230150,11230733,11233483,11234443,11235229,11235646,11237324,11237855,11238908,11239006,11239242,11239345,11240508,11241029,11242044,11242914,11244327,11244888,11866596,11891697,11893251,11936407,11936754,11940586,11946407,11949064,11951060,12007870,12020591,12066634,12076537,12078493,12079342,12082659,12083761,12141451,12168205,18254392,18255379,18255848,18255920,18256248,18256888,18257103,18257382,18257561,18257832,18257979,18258307,18258378,18258655,18258795,18259282,18259556,18259589,18259749,18259758,19410803,19410827,19412338,19412679,19413351,19414316,19414479,19415307,19415488,19415782,19415859,20128509,20130882,20132586,20133774,20133937,20134082,20147876,20149521,20154416,20156392,20158137,20175028,20179397,20180564,20183074,20183861,20190982,20194543,20197225,20197307,20197361,20199967,20207657,20210519,20258487,20261148,20261383,20270382,20280230,20282433,20310110,20332878,20337841,20341872,20343369,20344553,20344889,20345716,20389116,20392191,20399416,20399951,20399963,20409391,20411275,20419197,20423134,20428673,20440219,20446579,20448931,20453432,20462320,36990967,36991258,36991382,36991395,36991492,36991520,36991780,36991798,36991821,36991958,36992178,36992316,36992462,36992484,36992609,36992647,36992730,36992789,36992844,36993179,36993250,36993267,36993338,36993391,36993507,37004308,37004457,37004591,37004713,37004725,37004738,37004773,37004934,37004955,37005106,37005158,37005243,37005256,37005517,37005701,37005859,37005901,37005941,37005958,37005974,37005989,37006171,37006376,37006404,37006474,37006633,37006638,37006661,37006746,37006754,37006852,37006939,37006981,37007037,37007058,37007333,37007356,37007401,37007429,37007604,37007617,37007670,37007953,37007968,37007997,37008023,37008042,37008115,37008138,37008180,37008286,37008324,37008510,37008620,37008646,37008655,37008711,37008790,37008883,37009021,37009073,37009265,37009276,37009454,37009504,37009521,37009538,37009551,37009675,37009709,37009760,37010270,37010455,37141931,37141950,37142031,37142070,37142568,37142664,37142834,37143009,37143265,37143302,37143437,37143731,37144104,37144206,37144441,37144703,37144845,37145117,37145292,37145745,37145834,37146181,37146187,37146461,37146636,37147539,37148326,37148333,37148348,37148408,37148420,37148461,37148541,37148568,37148688,37148751,37148970,37149312,37149401,37149726,37149747,37149875,37150013,37150521,37150545,37150899,37151180,37151229,37151263,37151300,37151366,37151390,37151475,37151479,37151533,37151573,37151582,37151662,37151712,37152075,37152286,37152323,37152365,37152386,37152587,37153099,37153165,37153417,37153448,37153497,37153570,37153619,37153899,37154043,37154134,37154160,37154169,37154209,37154334,37154369,37154559,37154722,37154725,37154827,37155090,37155161,37155382,37155394,37155484,37155502,37155507,37155569,37155751,37155773,37155967,37156468,37156548,37156550,37156714,37157093,37157198,37157326,37157331,37157483,37157492,37157741,37157752,37157948,37158076,37158138,37158174,37158427,37158893,37159038,37159113,37159126,37159249,37159284,37159413,37159527,37159576,37159616,37159698,37159863,37159928,37160101,37160132,37160391,37160491,37160504,37160839,37160869,37161112,37161122,37161139,37161329,37161399,37161475,37161567,37161580,37161604,37161670,37161678,37162027,37162121,37162193,37162335,37162341,37162537,37163143,37163735,37164348,37164632,37164672,37165351,37165423,37165485,37165492,37165567,37165586,37166186,37166317,37166426,37166562,37166682,37166859,37247126,37247391,37247604,37248097,37248104,37248789,37248969,37249231,37249265,37249965,37250291,37250401,37250553,37250628,37251243,37251738,37251991,37252304,37252824,37253057,37254259,37254860,37254945,37259262,37262841,37262856,37264662,37273513,37290617,37290730,37293004,37293270,37293416,37293823,37295716,37295988,37296371,37296674,37296897,37297389,37298365,37299786,37301067,37301315,37301563,37301746,37303640,37304637,37304750,37309947,37310666,37310712,37311059,37311073,37311257,37311852,37312378,37312437,37313067,37318712,37319300,37319544,37319898,37320244,37321222,37322290,37322348,37322572,37322761,37322802,37323054,37323071,37325888,37327681,37330763,37330803,37333367,37344548,37349050,37349248,37349382,37352129,37352712
);


-- 
select id, file_id from contact_numbers_to_lcc cntl 
where cntl.branch_name is null
	and (cntl.remark_3 in ('ringi_not_contract', 'aseet_not_contract' ) or (cntl.remark_3 = 'prospect_sabc' and cntl.status in ('S','A','B','C'))) ;

update contact_numbers_to_lcc set branch_name = 'Head Office'
where id in (1043202,1079434,1089275,1090898,1104800,1131390,1167351,1350808,1355193,1364236,1366387,1366391,1369254,1380039,1382617,1383090,1386419,1389173,1389708,1392157,1393143,1426027,1448327,1461841,1467703,1467769,1468083,1469929,1475011,1475370,1477599,1482627,1485449,1488490,1488999,1492680,1494368,1496487,1497538,1502065,1502814,1504830,1508730,1508978,1510285,1512257,1512584,1512867,1519128,1519973,1558202,1559286,1563227,1566442,1573852,1574037,1574184,1577885,1580186,1581599,1582488,1582505,1583894,1588054,1590607,1591326,1591498,1592365,1594455,1594481,1594543,1596288,1596731,1597362,1599975,1600773,1601405,1603626,1605998,1607690,1613747,1616258,1617573,3232328,3235702,3429758,3438216,3500312,3634725,3677354,3678673,3689023,3704278,3751818,3770676,3783935,3787251,3795908,3796503,3827520,3836993,3837011,3842183,3845799,3848621,3848731,3883239,3889959,3922929,3933677,3934002,3950000,3953078,3966608,3970029,3979485,3981651,4030057,4068410,4068632,4083216,4089957,4111540,4161426,4162328,4168536,4173614,4179102,4187990,4201006,4203541,4203545,4213688,4217267,4219829,4221395,4222291,4222636,4225049,4225118,4225206,5742823,5743929,5807647,5813559,5823310,5823443,5823502,5823546,5823654,5823668,5823694,5840393,5840902,5889058,5902540,6019628,6241066,7318707,7328488,7336472,7339349,7367261,7378531,7378703,7381831,7461224,7467305,7480558,7489324,7490381,7580930,7597690,7597742,7624946,7625376,7631466,7635343,7693268,7705750,7709572,7728240,7741081,7753432,7769091,7778426,7782997,7784679,7839886,7844246,11086472,11114813,11145572,11213738,11240392,11240884,11896332,11928012,12027671,12033455,18793362,20203814,20223575,20410851,20438825,36991217,36995202,36996458,36997577,37000923,37003003,37005265,37005420,37005888,37005894,37008832,37009596,37012894,37014566,37015085,37015513,37016624,37021256,37023258,37025229,37025695,37025764,37033244,37035395,37035618,37042556,37042717,37043346,37045240,37049247,37054429,37067871,37075684,37076223,37078070,37080471,37083956,37085644,37086278,37089083,37090005,37091343,37094537,37106539,37123580,37125379,37125905,37126876,37128604,37131913,37133049,37136337,37141746,37150035,37159445,37162583,37243499,37260461,37266331,37268478,37283635,37284481,37285130,37286010,37291255,37306838,37316640,37317516,37322785,37324673,37345413,37348071,37349782,47524523
);

-- 
update contact_numbers_to_lcc cntl set branch_name = 'Luangprabang'
-- select count(*) from contact_numbers_to_lcc cntl -- 159409
where cntl.branch_name is null and (cntl.remark_3 = 'Telecom' and cntl.status in ('ETL_active','SMS_success') )
limit 40000;

update contact_numbers_to_lcc cntl set branch_name = 'Paksan'
-- select count(*) from contact_numbers_to_lcc cntl -- 159409
where cntl.branch_name is null and (cntl.remark_3 = 'Telecom' and cntl.status in ('ETL_active','SMS_success') )
limit 40000;

update contact_numbers_to_lcc cntl set branch_name = 'Savannakhet'
-- select count(*) from contact_numbers_to_lcc cntl -- 159409
where cntl.branch_name is null and (cntl.remark_3 = 'Telecom' and cntl.status in ('ETL_active','SMS_success') )
limit 40000;

update contact_numbers_to_lcc cntl set branch_name = 'Xiengkhouang'
-- select count(*) from contact_numbers_to_lcc cntl -- 159409
where cntl.branch_name is null and (cntl.remark_3 = 'Telecom' and cntl.status in ('ETL_active','SMS_success') )
limit 40000;


select count(*) from contact_numbers_to_lcc cntl -- 440189
where cntl.branch_name is null and (cntl.remark_3 = 'pbx_cdr' and cntl.status in ('ANSWERED') ) ;

update contact_numbers_to_lcc cntl set branch_name = 'Luangprabang'
where cntl.branch_name is null and (cntl.remark_3 = 'pbx_cdr' and cntl.status in ('ANSWERED') ) limit 20000;

update contact_numbers_to_lcc cntl set branch_name = 'Paksan'
where cntl.branch_name is null and (cntl.remark_3 = 'pbx_cdr' and cntl.status in ('ANSWERED') ) limit 30000;

update contact_numbers_to_lcc cntl set branch_name = 'Pakse'
where cntl.branch_name is null and (cntl.remark_3 = 'pbx_cdr' and cntl.status in ('ANSWERED') ) limit 10000;

update contact_numbers_to_lcc cntl set branch_name = 'Savannakhet'
where cntl.branch_name is null and (cntl.remark_3 = 'pbx_cdr' and cntl.status in ('ANSWERED') ) limit 10000;

update contact_numbers_to_lcc cntl set branch_name = 'Xiengkhouang'
where cntl.branch_name is null and (cntl.remark_3 = 'pbx_cdr' and cntl.status in ('ANSWERED') ) limit 10000;

update contact_numbers_to_lcc cntl set branch_name = 'Head Office'
where cntl.branch_name is null and (cntl.remark_3 = 'pbx_cdr' and cntl.status in ('ANSWERED') ) ;

#____________________________________________________________________________________________________________________#
#__________________________________________00 Import priority1 to LCC 00_____________________________________________#
-- ---------------------------------------------------------------------
#Priority1: 1) F&G SMS checked -- insert into contact_for_202208_lcc 
insert into contact_for_202209_lcc
select cntl.id, cntl.`file_id`,`contact_no`,`name`,cntl.province_eng,`province_laos`,cntl.district_eng,`district_laos`,cntl.`village`,cntl.`type`,`maker`,`model`,`year`, 
	'1' `remark_1`,`remark_2`,`remark_3`,cntl.`branch_name`,cntl.`status`, null `status_updated`, null `staff_id`,null `pvd_id`
-- select count(*) -- 275375
from contact_numbers_to_lcc cntl left join file_details fd on (fd.id = cntl.file_id)
where cntl.branch_name in ('Attapue','Bokeo','Head Office','Houaphan','LuangNamtha','Luangprabang','Oudomxay','Paksan','Pakse','Salavan','Savannakhet','Thakek','Vientiane province','Xainyabuli','Xiengkhouang')
	and (cntl.remark_3 = 'prospect_sabc' and cntl.status in ('F','G','G1','G2'))
	and cntl.id in (select id from temp_sms_chairman tean where date_updated >= '2022-08-01' and status = 1);

#____________________________________________________________________________________________________________________#
#__________________________________________00 Import priority2 to LCC 00_____________________________________________#
-- ---------------------------------------------------------------------
#Priority2: 2) Ringi_Asset_SABC -- insert into contact_for_202208_lcc 
insert into contact_for_202209_lcc
select cntl.id, cntl.`file_id`,`contact_no`,`name`,cntl.province_eng,`province_laos`,cntl.district_eng,`district_laos`,cntl.`village`,cntl.`type`,`maker`,`model`,`year`, 
	'2' `remark_1`,`remark_2`,`remark_3`,cntl.`branch_name`,cntl.`status`, null `status_updated`, null `staff_id`,null `pvd_id`
-- select count(*) -- 24297
from contact_numbers_to_lcc cntl left join file_details fd on (fd.id = cntl.file_id)
where cntl.branch_name in ('Attapue','Bokeo','Head Office','Houaphan','LuangNamtha','Luangprabang','Oudomxay','Paksan','Pakse','Salavan','Savannakhet','Thakek','Vientiane province','Xainyabuli','Xiengkhouang')
	and (cntl.remark_3 in ('ringi_not_contract', 'aseet_not_contract' ) or (cntl.remark_3 = 'prospect_sabc' and cntl.status in ('S','A','B','C'))) ;

#____________________________________________________________________________________________________________________#
#__________________________________________00 Import priority3 to LCC 00_____________________________________________#
-- ---------------------------------------------------------------------
#Priority3: 3) Telecom_active -- insert into contact_for_202208_lcc 
insert into contact_for_202209_lcc
select cntl.id, cntl.`file_id`,`contact_no`,`name`,cntl.province_eng,`province_laos`,cntl.district_eng,`district_laos`,cntl.`village`,cntl.`type`,`maker`,`model`,`year`, 
	'3' `remark_1`,`remark_2`,`remark_3`,cntl.`branch_name`,cntl.`status`, null `status_updated`, null `staff_id`,null `pvd_id`
-- select count(*) -- 424116
from contact_numbers_to_lcc cntl left join file_details fd on (fd.id = cntl.file_id)
where cntl.branch_name in ('Attapue','Bokeo','Head Office','Houaphan','LuangNamtha','Luangprabang','Oudomxay','Paksan','Pakse','Salavan','Savannakhet','Thakek','Vientiane province','Xainyabuli','Xiengkhouang')
	and (cntl.remark_3 = 'Telecom' and cntl.status in ('ETL_active','SMS_success') ) ;


#____________________________________________________________________________________________________________________#
#__________________________________________00 Import priority4 to LCC 00_____________________________________________#
-- ---------------------------------------------------------------------
#Priority3: 3) Telecom_active -- insert into contact_for_202208_lcc 
insert into contact_for_202209_lcc
select cntl.id, cntl.`file_id`,`contact_no`,`name`,cntl.province_eng,`province_laos`,cntl.district_eng,`district_laos`,cntl.`village`,cntl.`type`,`maker`,`model`,`year`, 
	'4' `remark_1`,`remark_2`,`remark_3`,cntl.`branch_name`,cntl.`status`, null `status_updated`, null `staff_id`,null `pvd_id`
-- select count(*) -- 2548122
from contact_numbers_to_lcc cntl left join file_details fd on (fd.id = cntl.file_id)
where cntl.branch_name in ('Attapue','Bokeo','Head Office','Houaphan','LuangNamtha','Luangprabang','Oudomxay','Paksan','Pakse','Salavan','Savannakhet','Thakek','Vientiane province','Xainyabuli','Xiengkhouang')
	and (cntl.remark_3 = 'pbx_cdr' and cntl.status in ('ANSWERED') ) ;



#____________________________________________________________________________________________________________________#
#__________________________________________00 Export priority1 and priority2 to LCC 00_____________________________________________#
-- --------------------------------Type ①Have Car-------------------------------------
#Export Priority1&2: ①Have Car
-- 4) export to create campaign on LCC
-- select count(*) 
 select `id`,`contact_no`,`name`,`province_eng`,`province_laos`,`district_eng`,`district_laos`,`village`,`type`,`maker`,`model`,`year`,`remark_1`,`remark_2`,`remark_3`
from contact_for_202209_lcc cntl 
where branch_name = 'Attapue' and `type` in( '①Have Car' ) -- '①Have Car' '②Need loan' '③Have address' '④Telecom'
	and cntl.remark_1 in ('1', '2');

-- --------------------------- Type ②Need loan ---------------------------
#Export Priority1&2: ②Need loan
-- 4) export to create campaign on LCC
-- select count(*) 
 select `id`,`contact_no`,`name`,`province_eng`,`province_laos`,`district_eng`,`district_laos`,`village`,`type`,`maker`,`model`,`year`,`remark_1`,`remark_2`,`remark_3`
from contact_for_202209_lcc cntl 
where branch_name = 'Attapue' and `type` in( '②Need loan' ) -- '①Have Car' '②Need loan' '③Have address' '④Telecom'
	and cntl.remark_1 in ('1', '2');

-- --------------------------- Type ③Have address ---------------------------
#Export Priority1&2: ③Have address
-- 4) export to create campaign on LCC
-- select count(*) 
 select `id`,`contact_no`,`name`,`province_eng`,`province_laos`,`district_eng`,`district_laos`,`village`,`type`,`maker`,`model`,`year`,`remark_1`,`remark_2`,`remark_3`
from contact_for_202209_lcc cntl 
where branch_name = 'Attapue' and `type` in( '③Have address' ) -- '①Have Car' '②Need loan' '③Have address' '④Telecom'
	and cntl.remark_1 in ('1', '2');

-- --------------------------- Type ④Telecom ---------------------------
#Export Priority1&2: ④Telecom
-- 4) export to create campaign on LCC
-- select count(*) 
 select `id`,`contact_no`,`name`,`province_eng`,`province_laos`,`district_eng`,`district_laos`,`village`,`type`,`maker`,`model`,`year`,`remark_1`,`remark_2`,`remark_3`
from contact_for_202209_lcc cntl 
where branch_name = 'Attapue' and `type` in( '④Telecom' ) -- '①Have Car' '②Need loan' '③Have address' '④Telecom'
	and cntl.remark_1 in ('1', '2');


#____________________________________________________________________________________________________________________#
#__________________________________________00 Export priority3 to LCC 00_____________________________________________#
-- --------------------------- Type ①Have Car ---------------------------
#Export Priority1&2: ①Have Car
-- 4) export to create campaign on LCC
-- select count(*) 
 select `id`,`contact_no`,`name`,`province_eng`,`province_laos`,`district_eng`,`district_laos`,`village`,`type`,`maker`,`model`,`year`,`remark_1`,`remark_2`,`remark_3`
from contact_for_202209_lcc cntl 
where branch_name = 'Xiengkhouang' and `type` in( '①Have Car' ) -- '①Have Car' '②Need loan' '③Have address' '④Telecom'
	and cntl.remark_1 in ('3') ;

-- --------------------------- Type ②Need loan ---------------------------
#Export Priority3
-- 4) export to create campaign on LCC
-- select count(*) 
 select `id`,`contact_no`,`name`,`province_eng`,`province_laos`,`district_eng`,`district_laos`,`village`,`type`,`maker`,`model`,`year`,`remark_1`,`remark_2`,`remark_3`
from contact_for_202209_lcc cntl 
where branch_name = 'Xiengkhouang' and `type` in( '②Need loan' ) -- '①Have Car' '②Need loan' '③Have address' '④Telecom'
	and cntl.remark_1 in ('3') ;

-- --------------------------- Type ③Have address ---------------------------
#Export Priority3
-- 4) export to create campaign on LCC
-- select count(*) 
 select `id`,`contact_no`,`name`,`province_eng`,`province_laos`,`district_eng`,`district_laos`,`village`,`type`,`maker`,`model`,`year`,`remark_1`,`remark_2`,`remark_3`
from contact_for_202209_lcc cntl 
where branch_name = 'Xiengkhouang' and `type` in( '③Have address' ) -- '①Have Car' '②Need loan' '③Have address' '④Telecom'
	and cntl.remark_1 in ('3') ;

-- --------------------------- Type ④Telecom ---------------------------
#Export Priority3
-- 4) export to create campaign on LCC
-- select count(*) 
 select `id`,`contact_no`,`name`,`province_eng`,`province_laos`,`district_eng`,`district_laos`,`village`,`type`,`maker`,`model`,`year`,`remark_1`,`remark_2`,`remark_3`
from contact_for_202209_lcc cntl 
where branch_name = 'Xiengkhouang' and `type` in( '④Telecom' ) -- '①Have Car' '②Need loan' '③Have address' '④Telecom'
	and cntl.remark_1 in ('3') ;



#____________________________________________________________________________________________________________________#
#__________________________________________00 Export priority4 to LCC 00_____________________________________________#
-- --------------------------------Type ①Have Car-------------------------------------
#Export Priority4: ①Have Car
-- 4) export to create campaign on LCC
-- select count(*) 
 select `id`,`contact_no`,`name`,`province_eng`,`province_laos`,`district_eng`,`district_laos`,`village`,`type`,`maker`,`model`,`year`,`remark_1`,`remark_2`,`remark_3`
from contact_for_202209_lcc cntl 
where branch_name = 'Attapue' and `type` in( '①Have Car' ) -- '①Have Car' '②Need loan' '③Have address' '④Telecom'
	and cntl.remark_1 in ('4');

-- --------------------------- Type ②Need loan ---------------------------
#Export Priority4: ②Need loan
-- 4) export to create campaign on LCC
-- select count(*) 
 select `id`,`contact_no`,`name`,`province_eng`,`province_laos`,`district_eng`,`district_laos`,`village`,`type`,`maker`,`model`,`year`,`remark_1`,`remark_2`,`remark_3`
from contact_for_202209_lcc cntl 
where branch_name = 'Attapue' and `type` in( '②Need loan' ) -- '①Have Car' '②Need loan' '③Have address' '④Telecom'
	and cntl.remark_1 in ('4');

-- --------------------------- Type ③Have address ---------------------------
#Export Priority4: ③Have address
-- 4) export to create campaign on LCC
-- select count(*) 
 select `id`,`contact_no`,`name`,`province_eng`,`province_laos`,`district_eng`,`district_laos`,`village`,`type`,`maker`,`model`,`year`,`remark_1`,`remark_2`,`remark_3`
from contact_for_202209_lcc cntl 
where branch_name = 'Attapue' and `type` in( '③Have address' ) -- '①Have Car' '②Need loan' '③Have address' '④Telecom'
	and cntl.remark_1 in ('4');

-- --------------------------- Type ④Telecom ---------------------------
#Export Priority4: ④Telecom
-- 4) export to create campaign on LCC
-- select count(*) 
 select `id`,`contact_no`,`name`,`province_eng`,`province_laos`,`district_eng`,`district_laos`,`village`,`type`,`maker`,`model`,`year`,`remark_1`,`remark_2`,`remark_3`
from contact_for_202209_lcc cntl 
where branch_name = 'Attapue' and `type` in( '④Telecom' ) -- '①Have Car' '②Need loan' '③Have address' '④Telecom'
	and cntl.remark_1 in ('4');







